<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Cache-Control" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta
      name="viewport"
      content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width"
    />
    <meta content="telephone=no" name="format-detection" />

    <script type="text/javascript">
      var label = `SIZE 60 mm,40 mm
      GAP 2 mm,0 mm
      DIRECTION 0
      SET RESPONSE ON
      REFERENCE 0,0
      DENSITY 4   
      CLS
      TEXT 10,0,"TSS24.BF2",0,1,1,"欢迎使用Printer"
      QRCODE 10,50,L,5,A,0," www.smarnet.cc"
      BARCODE 10,200,"128",100,1,0,2,2,"SMARNET"
      PRINT 1
      SOUND 2,100
      `;

      function btOpen() {
        if (!window.btPrinter) alert("蓝牙打印插件加载异常");
        var macAddress = document.getElementById("addr").value;
        log(macAddress);
        var status = btPrinter.open(macAddress);
        log(status);
      }

      function btPrint() {
        if (!window.btPrinter) alert("蓝牙打印插件加载异常");
        btPrinter.print(label);
      }

      function btClose(){
        if (!window.btPrinter) alert("蓝牙打印插件加载异常");
        btPrinter.close();
      }

      function btStatus(){
        if (!window.btPrinter) alert("蓝牙打印插件加载异常");
        btPrinter.onStatus = function(msg){
        log(msg);
        return 'ok'
        }
      }

      function log(msg) {
        document.getElementById("msg").innerText += msg + "\r\n";
      }
    </script>
  </head>
  <body>
    <h1>hello</h1>

    <input type="text" id="addr" value="DC:1D:30:B8:50:EB" />

    <br />
    <input type="button" value="连接" id="bt_con" onclick="btOpen()" />
    <br />
    <input type="button" value="打印" id="bt_print" onclick="btPrint()" />
    <br />
    <input type="button" value="断开" id="bt_close" onclick="btClose()" />
    <br />
    <br />
    <input type="button" value="状态" id="bt_status" onclick="btStatus()" />
    <br />
    <span id="msg"></span>
  </body>
</html>
